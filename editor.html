<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Редактор поста</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f9; margin: 0; padding: 18px; color:#111; }
    h2 { text-align:center; margin: 8px 0 12px; }
    textarea { width:100%; height:240px; padding:10px; font-size:15px; border-radius:8px; border:1px solid #ccc; box-sizing:border-box; }
    .btn { margin-top:12px; display:block; width:100%; padding:12px; font-size:16px; border:none; border-radius:8px; cursor:pointer; background:#1e88e5; color:white; }
    .btn-secondary { background:#6c757d; }
    .note { margin-top:8px; font-size:13px; color:#444; }
  </style>
</head>
<body>
  <h2>✍️ Редактор поста</h2>

  <textarea id="postText" placeholder="Введіть текст вашого оголошення..."></textarea>
  <button id="saveBtn" class="btn">✅ Зберегти та надіслати</button>
  <div class="note">Після збереження WebApp автоматично закриється і бот отримає текст.</div>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    const tg = window.Telegram?.WebApp;
    if (tg && tg.expand) tg.expand();

    function getQueryParam(name) {
      try {
        return new URLSearchParams(window.location.search).get(name);
      } catch (e) {
        return null;
      }
    }

    // если пришёл текст в ?post=..., подставим его в textarea
    const pre = getQueryParam('post');
    if (pre) {
      try {
        document.getElementById('postText').value = decodeURIComponent(pre);
      } catch (e) {
        document.getElementById('postText').value = pre;
      }
    }

    document.getElementById('saveBtn').addEventListener('click', function() {
      const text = document.getElementById('postText').value.trim();
      if (!text) { alert('Введіть текст!'); return; }
      if (tg && tg.sendData) {
        tg.sendData(text);   // отправляем текст в бот
        try { tg.close(); } catch(e) {}
      } else {
        // Если не внутри Telegram, просто покажем текст (для теста в браузере)
        alert("Текст (для теста):\n\n" + text);
      }
    });
  </script>
</body>
</html>




      

 